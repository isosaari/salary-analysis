---
title: "Regression Analysis of Average Hourly Wage"
format: html
toc: true
code-fold: show
theme: cosmo
warning: false
message: false
author: Arttu Isosaari
---


## Summary

This work analyzes data from 1976 (wage1) and examines how the length of education and work experience relate to average hourly wage.

The analysis progresses from simple regression models to a multivariate model, where the effects of education and work experience are assessed simultaneously. In addition, results are illustrated graphically and the explanatory power of the models is compared.

The purpose of this work is to demonstrate basic skills in statistical modeling with R, interpretation of results, and clear reporting of the analysis.


## Data and Research Question

The analysis uses the `wage1` dataset, which contains information on 526 individuals from 1976. The dataset includes, among other things, information on average hourly wage, place of residence, amount of education, etc.

The research question is: Can (and if so, how well) average hourly wage be explained by education and work experience, separately and together?


## Fitting the Regression Model

We estimate linear regression models to examine the research questions. We illustrate the situations both visually and statistically

```{r}
#| label: setup
#| include: false

library(wooldridge)
library(car)
data(wage1)
```


### Education and Hourly Wage

```{r}
#| label: plot-educ
#| fig-cap: "Scatter plot of average hourly wage relative to length of education"

fit1 <- lm(wage ~ educ, data = wage1)
plot(wage1$educ, wage1$wage, 
     main = "Length of education and average hourly wage in 1976",
     xlab = "Length of education in years",
     ylab = "Average hourly wage")
abline(fit1)
```

The scatter plot reveals to us that the linear model shows a positive relationship between the length of education and hourly wage. The fitted regression line slopes upward, which suggests that longer education has on average a positive relationship with wage, which seems very intuitive.

However, it is observed that the residuals are large and longer education appears to increase deviations. In other words, variation is much greater when the length of education increases. This means that education explains hourly wage positively, but along with it, the variance between observations increases.

Let us examine this statistically:

```{r}
#| label: model1
#| include: false

fit1 <- lm(wage ~ educ, data = wage1)
summary1 <- summary(fit1)
```

```{r}
#| label: results1
#| echo: false

summary1
```

The results show a statistically significant positive relationship. The test statistic is approximately 103, which is extremely large and strongly rejects the null hypothesis that there is no relationship. The R² coefficient tells us what proportion of the variation in wages is explained by education.

Nevertheless, it should be noted that the large residuals suggest that clearly other factors besides education affect total hourly earnings.


### Potential Work Experience and Hourly Wage

Let us first clarify what *potential* work experience means. It refers to the time during which a person has been able to be in the workforce. It does not directly tell us the time during which the person has actually been working.

```{r}
#| label: plot-exper
#| fig-cap: "Scatter plot of average hourly wage relative to potential work experience"

fit2 <- lm(wage ~ exper, data = wage1)
plot(wage1$exper, wage1$wage, 
     main = "Work experience and average hourly wage in 1976",
     xlab = "Length of potential work experience in years",
     ylab = "Average hourly wage")
abline(fit2)
```

The relationship between (potential) work experience and wages also appears positive, but the pattern differs from education. The scatter plot shows that wages generally increase with experience, but the relationship appears clearly weaker than with education. Variation, on the other hand, is already substantial in this case. It is also noted that variation is greatest around 20–30 years and most observations are clearly at the beginning.

Let us examine this statistically:

```{r}
#| label: model2
#| include: false

fit2 <- lm(wage ~ exper, data = wage1)
summary2 <- summary(fit2)
```

```{r}
#| label: results2
#| echo: false

summary2
```

The test statistic is approximately 6.8, which is considerably smaller than with education (103). The test statistic is so large that the null hypothesis would be rejected at all normal significance levels. What does this tell us? It tells us that there is some statistically significant relationship, i.e., a linear model can in principle be fitted. Nevertheless, the variance is truly substantial and there is so much scatter everywhere that explaining average hourly wage with work experience alone is not meaningful.

### Education and Work Experience Together

```{r}
#| label: avplots
#| fig-cap: "Education and work experience as predictors of average hourly wage"
fit3 <- lm(wage ~ educ + exper, data = wage1)
avPlots(fit3, main = "Education and work experience as predictors of average hourly wage", 
        id = FALSE)

```


Partial regression plots illustrate the partial relationships between wages and each explanatory variable. The left side shows the relationship between wages and education after removing the effect of experience, while the right side shows the relationship between wages and experience after removing the effect of education.

In both panels, the positive slopes confirm that both education and experience have independent positive relationships with wages, even when the correlation between them is taken into account. The scatter around the fitted lines in these plots represents residual variation that the model does not explain.

```{r}
#| label: model3
#| include: false

fit3 <- lm(wage ~ educ + exper, data = wage1)
summary3 <- summary(fit3)
```

```{r}
#| label: results3
#| echo: false

summary3
```

In the third model, both education and work experience are taken into account as explanatory variables. This is necessary because education and experience may be correlated and their individual effects may be confounded when examined separately.


## Explanatory Power

```{r}
#| label: r-squared-comparison
#| echo: false

cat("Model 1 (education only) R²:", round(summary1$r.squared, 4), "\n")
cat("Model 2 (experience only) R²:", round(summary2$r.squared, 4), "\n")
cat("Model 3 (education + experience) R²:", round(summary3$r.squared, 4), "\n")
```

When examining the degree of explanatory power, it is noted that it is highest when both experience and education are predictors. It is also noted that based on the data, education explains average hourly wage better overall than experience, because its explanatory power is higher. This seems natural after the analysis just performed. 


## Summary


The analysis yields several different dimensions. First, both education and experience are individually associated with higher average hourly wages, as the statistically significant positive coefficients in the simple regression models show. Second, when the variables are examined together in a multivariate model, both remain significant predictors of wages, which suggests that they complement each other in explaining wages. 

Despite these observations, it is important to note that a substantial portion of the variation in wages remains unexplained by these two variables. The R² values, although they show meaningful relationships, leave a substantial portion of the variation in wages unexplained. This suggests that other factors—such as ability, industry, occupation, location, or unobserved characteristics—significantly affect wage determination.

In the end, it thus appears that the more predictors we add, the greater the explanatory power ultimately is. However, we cannot say this for certain based on this dataset. 

